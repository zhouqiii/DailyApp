(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["writedailypage"],{"065e":function(t,e,n){},"0d8c":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"home_editBox_content"},[n("div",{staticClass:"ruleForm"},[n("div",{staticClass:"formItem"},[n("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[n("van-collapse-item",{attrs:{title:"任务",name:"1"},scopedSlots:t._u([{key:"value",fn:function(){return[t._v(" "+t._s(t.commision)+" ")]},proxy:!0}])},t._l(t.commiListThe,(function(e,i){return n("div",{key:i},[n("div",[n("van-radio-group",{model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[n("van-cell",{attrs:{title:e,clickable:""},scopedSlots:t._u([{key:"right-icon",fn:function(){return[n("van-radio",{attrs:{name:i},on:{click:function(e){return t.getRadioIndex(i)}}})]},proxy:!0}],null,!0)})],1)],1)])})),0)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.dailyShow,expression:"dailyShow"}],staticClass:"formItem"},[n("van-field",{attrs:{"is-link":"",readonly:"",label:"工时",placeholder:"请选择"},on:{click:function(e){t.showPickerHour=!0}},model:{value:t.workHour,callback:function(e){t.workHour=e},expression:"workHour"}}),n("van-popup",{attrs:{round:"",position:"bottom"},on:{close:t.getWorkContent},model:{value:t.showPickerHour,callback:function(e){t.showPickerHour=e},expression:"showPickerHour"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.hourSelects},on:{cancel:function(e){t.showPickerHour=!1},confirm:t.onConfirmHour}})],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.dailyShow,expression:"!dailyShow"}]},[n("div",{staticClass:"formItem box_frame-row"},[n("van-field",{attrs:{"is-link":"",readonly:"",label:"开始时间",placeholder:"请选择"},on:{click:function(e){t.startTimeHM=!0}},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),n("van-popup",{attrs:{position:"bottom"},on:{close:t.getWorkContent},model:{value:t.startTimeHM,callback:function(e){t.startTimeHM=e},expression:"startTimeHM"}},[n("van-datetime-picker",{attrs:{type:"time",title:" ",formatter:t.formatterTime},on:{cancel:function(e){t.startTimeHM=!1},confirm:t.onConfirmStartHM},model:{value:t.currentStart,callback:function(e){t.currentStart=e},expression:"currentStart"}})],1)],1),n("div",{staticClass:"formItem"},[n("van-field",{attrs:{"is-link":"",readonly:"",label:"结束时间",placeholder:"请选择"},on:{click:function(e){t.endTimeHM=!0}},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),n("van-popup",{attrs:{position:"bottom"},on:{close:t.getWorkContent},model:{value:t.endTimeHM,callback:function(e){t.endTimeHM=e},expression:"endTimeHM"}},[n("van-datetime-picker",{attrs:{type:"time",title:" ",formatter:t.formatterTime},on:{cancel:function(e){t.endTimeHM=!1},confirm:t.onConfirmEndHM},model:{value:t.currentEnd,callback:function(e){t.currentEnd=e},expression:"currentEnd"}})],1)],1)]),n("div",[n("div",{staticClass:"workTitle"},[t._v("今日工作")]),n("van-field",{staticClass:"textareaEdit",staticStyle:{height:"4.5rem","text-align":"left"},attrs:{rows:"2",type:"textarea",placeholder:"请输入工作内容(最少10个字)"},on:{input:t.getWorkContent},model:{value:t.workContent,callback:function(e){t.workContent=e},expression:"workContent"}})],1)])])])},a=[],o={name:"WorkInfo",props:["daily","commiList","taskList"],data:function(){return{workHour:"",showPickerHour:!1,hourSelects:["2小时","4小时","6小时","8小时"],activeNames:["1"],commiListThe:[],commision:"",radio:0,workContent:"",show:!0,dailyShow:"",startTime:"18:30",startTimeHM:!1,currentStart:"18:30",currentEnd:"21:30",endTime:"21:30",endTimeHM:!1,projectId:"",taskListThe:[],taskId:""}},methods:{formatterTime:function(t,e){return"hour"===t?"".concat(e,"时"):"minute"===t?"".concat(e,"分"):e},getRadioIndex:function(t){this.taskId=this.taskListThe[t],this.commision=this.commiList[t]},onConfirmHour:function(t){this.workHour=t,this.showPickerHour=!1},onConfirmStartHM:function(t){this.startTime=t,this.startTimeHM=!1},onConfirmEndHM:function(t){this.endTime=t,this.endTimeHM=!1},sendFlag:function(t){return this.flagToParent=t,this.flagToParent},getWorkContent:function(){this.$emit("checkInput")},assignTask:function(){this.commiListThe=this.commiList,this.taskListThe=this.taskList,this.taskId=this.taskListThe[0],this.commision=this.commiList[0]}},mounted:function(){this.dailyShow=this.daily,this.assignTask()},watch:{commiList:{handler:function(){this.assignTask()}}}},s=o,r=(n("5b56"),n("2877")),c=Object(r["a"])(s,i,a,!1,null,"734747bb",null);e["a"]=c.exports},2052:function(t,e,n){},"5b56":function(t,e,n){"use strict";n("2052")},a434:function(t,e,n){"use strict";var i=n("23e7"),a=n("23cb"),o=n("a691"),s=n("50c4"),r=n("7b0b"),c=n("65f0"),l=n("8418"),d=n("1dde"),u=d("splice"),m=Math.max,h=Math.min,f=9007199254740991,k="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var n,i,d,u,p,v,w=r(this),b=s(w.length),g=a(t,b),T=arguments.length;if(0===T?n=i=0:1===T?(n=0,i=b-g):(n=T-2,i=h(m(o(e),0),b-g)),b+n-i>f)throw TypeError(k);for(d=c(w,i),u=0;u<i;u++)p=g+u,p in w&&l(d,u,w[p]);if(d.length=i,n<i){for(u=g;u<b-i;u++)p=u+i,v=u+n,p in w?w[v]=w[p]:delete w[v];for(u=b;u>b-i+n;u--)delete w[u-1]}else if(n>i)for(u=b-i;u>g;u--)p=u+i-1,v=u+n-1,p in w?w[v]=w[p]:delete w[v];for(u=0;u<n;u++)w[u+g]=arguments[u+2];return w.length=b-i+n,d}})},ecbb:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("nav-bar-top",{attrs:{title:"写日报"}}),n("div",{staticClass:"home"},[n("div",{staticClass:"home_editBox"},[n("div",{staticClass:"home_editBox_time box_frame-row"},[n("div",[t._v("填写日期")]),n("div",{staticClass:"edit_date"},[n("van-field",{staticClass:"getTime",attrs:{"is-link":"",readonly:"",label:""},on:{click:function(e){t.startTimePop=!0}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),n("van-popup",{attrs:{position:"bottom"},model:{value:t.startTimePop,callback:function(e){t.startTimePop=e},expression:"startTimePop"}},[n("van-datetime-picker",{attrs:{type:"month-day",title:" ","max-date":t.maxDate,formatter:t.formatterMD},on:{confirm:t.onConfirmEndTime,cancel:function(e){t.startTimePop=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)]),t._l(t.editList,(function(e,i){return n("work-info",{key:e.id,ref:"child",refInFor:!0,attrs:{daily:t.daily,commiList:t.commiList,taskList:t.taskList},on:{checkInput:t.checkInput},nativeOn:{touchstart:function(e){return t.touchinUk(i)},touchend:function(e){return t.cleartime(i)}}})})),n("div",{staticClass:"home_editBox_iconAdd",on:{click:t.addeditbox}},[n("svg-icon",{staticClass:"iconBig",attrs:{iconClass:"tianjia"}})],1)],2)]),n("div",{staticClass:"submit_btn"},[n("button",{staticClass:"sendBtn",style:t.thisStyle,attrs:{disabled:t.disabledCommit},on:{click:t.sendData}},[t._v("提交日报")])])],1)},a=[],o=(n("99af"),n("159b"),n("a434"),n("065e"),n("22ff")),s=n("0032"),r=n("0d8c"),c=n("8521"),l=0,d={components:{SvgIcon:s["a"],WorkInfo:r["a"]},name:"WriteDaily",data:function(){return{editList:[{id:0}],startDate:"",Loop:"",startTimePop:!1,maxDate:new Date,currentDate:new Date,sendDate:"",daily:!0,thisStyle:"",disabledCommit:!0,commiList:[],taskList:[]}},methods:{defaultProject:function(){var t=this;this.requestAxios({url:"/businessTask/business-task/getListTaskByUser",data:{},method:"post"}).then((function(e){e.data.length>0&&(t.commiList=[],t.taskList=[],Array.prototype.forEach.call(e.data,(function(e){t.commiList.push(e.taskName),t.taskList.push(e.taskId)})))})).catch((function(){}))},formatterMD:function(t,e){return"month"===t?"".concat(e,"月"):"day"===t?"".concat(e,"日"):e},formatDate:function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(e,"月").concat(n,"日")},formatDateSend:function(t){var e=parseInt(t.getMonth()+1,10)<10?"0".concat(t.getMonth()+1):t.getMonth()+1,n=parseInt(t.getDate(),10)<10?"0".concat(t.getDate()):t.getDate(),i=(new Date).getFullYear();return"".concat(i,"-").concat(e,"-").concat(n)},onConfirmEndTime:function(t){this.startTimePop=!1,this.startDate="".concat(this.formatDate(t)),this.sendDate="".concat(this.formatDateSend(t)),this.weekdayshow="星期".concat("日一二三四五六".charAt(t.getDay()))},addeditbox:function(){var t=this;l+=1,this.editList.push({id:l}),this.$nextTick((function(){t.checkInput()}))},checkInput:function(){var t=!0;this.$refs.child.forEach((function(e){e.workContent&&e.workHour||(t=!1)})),t?(this.disabledCommit=!1,this.thisStyle="background:rgb(102, 102, 102)"):(this.disabledCommit=!0,this.thisStyle="background:#d3d3d3")},sendData:function(){var t=this,e=!0,n=[],i=0;Array.prototype.forEach.call(this.$refs.child,(function(t){var a=parseInt(t.workHour.substring(0,1),10);i+=a;var o={};o.taskId=t.taskId,o.taskName=t.commiList[t.radio],o.workerLength=parseInt(t.workHour.substring(0,1),10),o.workerInfo=t.workContent,o.workerInfo.length<10&&(e=!1),n.push(o)})),e?i<8?Object(o["a"])(c["a"],{},{content:'<div style="text-align:center">填写工时不足8小时，请检查工时!</div>',knowBtn:!0}):i>8?Object(o["a"])(c["a"],{},{content:'<div style="text-align:center">填写工时已超 8 小时,请检查工时!</div>',knowBtn:!0}):this.requestAxios({url:"/workDaily/work-daily/save",data:{workDate:this.sendDate,createPerson:this.storage.get("username"),createTime:this.formatTime(new Date),dailyDetailList:n},method:"post"}).then((function(e){e.success?t.$router.push({path:"/ApplyEnd",query:{pageend:0}}):Object(o["a"])(c["a"],{},{content:'<div style="text-align:center">'.concat(e.message,'</div><div style="text-align:center;margin-top:.5rem">请重新提交！</div>'),knowBtn:!0})})).catch((function(){})):Object(o["a"])(c["a"],{},{content:'<div style="text-align:center">工作内容最少为10个字，请检查！</div>',knowBtn:!0})},formatTime:function(t){var e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return e=parseInt(e,10)<10?"0".concat(e):e,n=parseInt(n,10)<10?"0".concat(n):n,i=parseInt(i,10)<10?"0".concat(i):i,"".concat(e,":").concat(n,":").concat(i)},touchinUk:function(t){var e=this;clearInterval(this.Loop),this.Loop=setTimeout((function(){e.$dialog.confirm({message:"是否删除?"}).then((function(){e.editList.splice(t,1)})).catch((function(){}))}),1e3)},cleartime:function(){clearInterval(this.Loop)}},mounted:function(){this.sendDate=this.formatDateSend(new Date),this.startDate=this.formatDate(new Date),this.defaultProject()},watch:{}},u=d,m=n("2877"),h=Object(m["a"])(u,i,a,!1,null,null,null);e["default"]=h.exports}}]);